<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>GasBack Lite</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://terminal.jup.ag/main-v2.js"></script>
    <style>
        body{margin:0;background:#0b0f19;color:#fff;font-family:system-ui}
        .wrap{max-width:960px;margin:24px auto;padding:16px}
        .pill{background:#141a2a;border:1px solid #223055;border-radius:999px;padding:6px 10px;font-size:12px}
        #jupiter-terminal{height:640px}
        
        /* Onglets */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tab-button {
            background: #1b2a4d;
            border: 1px solid #223055;
            border-radius: 10px;
            padding: 10px 14px;
            cursor: pointer;
            color: white;
        }
        
        .tab-button.active {
            background: #2a3a6d;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="wrap">
        <div class="tabs">
            <div class="tab-button active" onclick="showTab('swap')">TOKENS SWAP</div>
            <div class="tab-button" onclick="showTab('whale')">WHALE TRACKER</div>
            <div class="tab-button" onclick="showTab('how')">HOW IT WORKS</div>
        </div>
        
        <div id="swap-tab" class="tab-content active">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
                <div><strong>GasBack Lite</strong> — <span id="pair">…</span></div>
                <div class="pill" id="cfg">slip: –, fee: – bps</div>
            </div>
            <div id="jupiter-terminal"></div>
        </div>
        
        <div id="whale-tab" class="tab-content">
            <h2>Whale Tracker</h2>
            <p>Whale tracking information...</p>
        </div>
        
        <div id="how-tab" class="tab-content">
            <h2>How GasBack Works</h2>
            <p>1. Swap Tokens: Use our integrated Jupiter swap interface to exchange any SPL tokens on Solana. Up to 80% fee cashback on your wallet.</p>
            <p>2. Earn more with GASD token: blablabla</p>
        </div>
    </div>

    <script>
    (function(){
        const qs = new URLSearchParams(location.search);
        const inMint  = qs.get("in")  || "So11111111111111111111111111111111111111112";
        const outMint = qs.get("out") || "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v";
        const amt     = qs.get("amt") || "0.10";
        const slip    = parseInt(qs.get("slip") || "50",10);
        const feeBps  = parseInt(qs.get("feeBps")|| "10",10);

        document.getElementById("pair").textContent = short(inMint)+" → "+short(outMint);
        document.getElementById("cfg").textContent  = `slip: ${slip} bps, fee: ${feeBps} bps`;

        const FEE_ACCOUNTS = {
            "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v": "Az9kgSbqq72dPTUKtMuFEp1qQhqi3gUobysNFNQp9K78"
        };

        const endpoint = "https://solana-rpc.publicnode.com";

        if (!window.Jupiter) { 
            alert("Jupiter bloqué. Désactive bloqueurs et recharge."); 
            return; 
        }

        window.Jupiter.init({
            container: document.getElementById("jupiter-terminal"),
            containerStyles: { height: "640px" },
            displayMode: "integrated",
            integrated: true,
            endpoint,
            defaultInputMint: inMint,
            defaultOutputMint: outMint,
            defaultInputAmount: amt.toString(),
            slippageBps: slip,
            platformFeeAndAccounts: { 
                feeBps: 10, 
                feeAccounts: FEE_ACCOUNTS 
            },
            referral: {
                ref: "www.whtg1.com"
            }
        });

        function short(x){ return x.slice(0,4)+"…"+x.slice(-4); }
    })();
    
    // Fonction pour gérer les onglets
    function showTab(tabName) {
        // Cacher tous les onglets
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        
        // Désactiver tous les boutons
        document.querySelectorAll('.tab-button').forEach(button => {
            button.classList.remove('active');
        });
        
        // Afficher l'onglet sélectionné
        document.getElementById(tabName + '-tab').classList.add('active');
        
        // Activer le bouton sélectionné
        event.target.classList.add('active');
    }
    </script>
</body>
</html>